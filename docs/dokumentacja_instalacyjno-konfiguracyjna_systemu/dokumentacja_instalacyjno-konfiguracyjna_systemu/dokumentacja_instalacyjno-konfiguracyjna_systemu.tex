\documentclass[12pt,a4paper,oneside]{article}

\usepackage[QX]{polski}
\usepackage[utf8]{inputenc}
\usepackage{latexsym}
\usepackage{tgpagella}
\usepackage{lmodern}
\usepackage{amsmath,amsthm,amsfonts,amssymb,alltt}
\usepackage{epsfig}
\usepackage{graphicx}
\usepackage{pdflscape}
\usepackage{caption}
\usepackage{indentfirst}
\usepackage{float}
\bibliographystyle{plabbrv}

\usepackage{color}
\usepackage[polish]{babel}
\usepackage{datetime2}
\usepackage[x11names,dvipsnames,table]{xcolor}
\usepackage{hyperref}
\hypersetup{
  pdfauthor={Zespół WasteFree},
  colorlinks=True,
  linkcolor=darkgray,
  citecolor=BrickRed,
  filecolor=Magenta,
  urlcolor=BlueViolet
}

% diagramy, grafy itp.
\usepackage{tikz}
\usetikzlibrary{positioning}
\usetikzlibrary{arrows}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{chains,fit,shapes,calc}

% algorytmy
\usepackage[linesnumbered,lined,commentsnumbered]{algorithm2e}
\SetKwFor{ForEach}{for each}{do}{end for}%
\SetKwFor{ForAll}{for all}{do}{end for}%
\newenvironment{myalgorithm}
{\rule{\textwidth}{0.5mm}\\\SetAlCapSty{}\SetAlgoNoEnd\SetAlgoNoLine\begin{algorithm}}{\end{algorithm}\rule{\textwidth}{0.5mm}}

%---------------------
% Wyłączamy znacznik overfull boxes (czarne prostokąty na marginesie)
\overfullrule=0pt
\pagestyle{plain}
\textwidth=15cm \textheight=685pt \topmargin=-25pt \linespread{1.3}
\setlength{\parskip}{0pt}
\setlength\arraycolsep{2pt}
\oddsidemargin = 0.9cm
\evensidemargin =-0.1cm
\captionsetup{width=.95\linewidth, justification=centering}
\renewcommand\figurename{Rys.}
\numberwithin{equation}{section}
\renewcommand{\thefootnote}{\arabic{footnote})}
%---------------------

\begin{document}

% TikZ style (po \begin{document} aby uniknąć ostrzeżeń kompilatora)
  \tikzset{main node/.style={circle,fill=blue!20,draw,minimum size=1cm,inner sep=0pt}}

\thispagestyle{empty}
\begin{titlepage}
\begin{center}\Large
Uniwersytet Komisji Edukacji Narodowej w Krakowie\\
\large
Instytut Bezpieczeństwa i Informatyki\\
\vskip 10pt
\end{center}
\begin{center}
\centering
\IfFileExists{images/logo.png}{\includegraphics[width=1.0\columnwidth]{images/logo.png}}{\fbox{Brak pliku images/logo.png}}
\end{center}

\begin{center}
 {\bf \fontsize{14pt}{14pt}\selectfont PROJEKT INŻYNIERSKI\\ DOKUMENTACJA INSTALACJI I KONFIGURACJI}
\end{center}
\vskip 5pt
\begin{center}
 {\bf \fontsize{22pt}{22pt}\selectfont System WasteFree Cloud do efektywnego zarządzania odpadami}
\end{center}

\begin{center}
 {\fontsize{12pt}{12pt}\selectfont wykonany przez: }
\end{center}
\begin{center}
 {\bf\fontsize{16pt}{16pt}\selectfont Dawid Plata}\\
 {\fontsize{12pt}{12pt}\selectfont Nr albumu: 165303 \\\&\\}
 {\bf\fontsize{16pt}{16pt}\selectfont Michał Szymbara}\\
 {\fontsize{12pt}{12pt}\selectfont Nr albumu: 165297 \\\&\\}
 {\bf\fontsize{16pt}{16pt}\selectfont Michał Wechmann}\\
 {\fontsize{12pt}{12pt}\selectfont Nr albumu: 165298}
\end{center}
\begin{center}
 {\fontsize{12pt}{12pt}\selectfont pod opieką:}\\
 {\bf\fontsize{12pt}{12pt}\selectfont dr Wojciech Gwizdała}\\
 {\bf\fontsize{12pt}{12pt}\selectfont mgr Wojciech Baran}
\end{center}

%\mbox{}
\vspace*{\fill}
%\vskip 50pt
\begin{center}
\large
Kraków \the\year\\
(ostatnia aktualizacja: \DTMcurrenttime,\;\today)
\end{center}
\end{titlepage}
\setcounter{page}{0}
	\tableofcontents
\newpage

\section{Wstęp}
\subsection{Cel dokumentu}
Dokument prowadzi administratora przez pełny proces uruchomienia systemu WasteFree: wymagania, instalację, konfigurację, uruchomienie, testy i utrzymanie.
\subsection{Zakres}
Backend (.NET 9 / ASP.NET Core), frontend (Angular 17), baza danych (EF Core, domyślnie SQL Server / inny zgodny), usługi dodatkowe i kontenery Docker/Compose.
\subsection{Odbiorcy}
Administratorzy i inżynierowie wdrożeń odpowiedzialni za przygotowanie środowisk (dev/test/prod).

\section{Wymagania sprzętowe}
\subsection{Minimalne}
\begin{itemize}
  \item CPU: 2 rdzenie; RAM: 4 GB.
  \item Dysk: 4 GB wolnego miejsca na repozytorium, zależności, obrazy Docker.
  \item Dostęp do internetu w celu pobrania paczek NuGet/NPM oraz obrazów.
\end{itemize}
\subsection{Zalecane}
\begin{itemize}
  \item CPU: 4 rdzenie; RAM: 8 GB+ (komfortowa praca z Docker i buildami Angular).
  \item SSD na zależności i obrazy; stałe łącze sieciowe.
\end{itemize}

\section{Środowisko uruchomieniowe}
\subsection{System operacyjny}
Windows 10/11, Ubuntu 22.04+, macOS 12+. W przykładach poniżej ścieżki podano w konwencji Windows/PowerShell.
\subsection{Narzędzia i wersje}
\begin{itemize}
  \item .NET SDK: \textbf{9.0.x} (wymagany przez projekt `WasteFree.Api`).
  \item Node.js: \textbf{\raisebox{-0.4ex}{\textasciitilde}18.19+} lub 20.x (zalecane 20 LTS) dla Angular 17; npm w zestawie.
  \item Angular CLI: 17.x (instalacja lokalna w projekcie UI, globalna opcjonalna: \texttt{npm install -g @angular/cli@17}).
  \item Docker + Docker Compose (opcjonalnie do uruchomienia kontenerowego).
  \item Git.
  \item SQL Server (lokalny / zewnętrzny) lub kompatybilny silnik wspierany przez EF Core; aktualnie przykłady zakładają SQL Server.
\end{itemize}
\subsection{Pobranie kodu}
\begin{verbatim}
git clone https://github.com/<org>/WasteFree.git
cd WasteFree
\end{verbatim}

\section{Struktura repozytorium (skrót)}
\begin{itemize}
  \item `API/` – backend (.NET 9), główny projekt `WasteFree.Api`.
  \item `UI/` – frontend Angular 17, pliki konfiguracyjne npm/Angular CLI.
  \item `docker-compose.yml` – definicje usług (API + opcjonalne usługi).
  \item `docs/` – dokumentacja projektu (bieżący plik).
\end{itemize}

\section{Konfiguracja środowiska}
\subsection{Backend (.NET 9)}
\begin{verbatim}
cd API
dotnet restore
\end{verbatim}
Pliki konfiguracyjne:
\begin{itemize}
  \item `WasteFree.Api/appsettings.Development.json` – ustawienia lokalne (developer).
  \item `WasteFree.Api/appsettings.Docker.json` – ustawienia dla uruchomień kontenerowych.
  \item Kluczowe sekcje: `ConnectionStrings:DefaultConnection`, ustawienia JWT, integracje zewnętrzne.
\end{itemize}

\subsection{Baza danych i migracje}
Przed uruchomieniem API ustaw connection string i zastosuj migracje EF Core:
\begin{verbatim}
cd API
dotnet ef database update `
  --project WasteFree.Infrastructure `
  --startup-project WasteFree.Api
\end{verbatim}
\begin{figure}[H]
  \centering
  \fbox{\parbox{0.9\textwidth}{Miejsce na zrzut ekranu: wynik \texttt{dotnet ef database update}}}
  \caption{Migracje bazy danych}
\end{figure}

\subsection{Frontend (Angular 17)}
\begin{verbatim}
cd UI
npm install
\end{verbatim}
Konfiguracja środowisk znajduje się w `UI/src/environments/environment*.ts` (np. adres API).

\subsection{Docker / Docker Compose (opcjonalnie)}
Wymagane działające Docker Engine i Compose.
\begin{verbatim}
docker compose pull   # opcjonalnie, aby pobrać obrazy bazowe
\end{verbatim}

\section{Instalacja i uruchomienie krok po kroku}
\subsection{Backend – tryb deweloperski}
\begin{verbatim}
cd API
dotnet run --project WasteFree.Api --launch-profile Development
\end{verbatim}
\begin{figure}[H]
  \centering
  \fbox{\parbox{0.9\textwidth}{Miejsce na zrzut ekranu: log startu API / endpoint \texttt{/swagger}}}
  \caption{Uruchomienie backendu}
\end{figure}

\subsection{Frontend – tryb deweloperski}
\begin{verbatim}
cd UI
npm run start
\end{verbatim}
\begin{figure}[H]
  \centering
  \fbox{\parbox{0.9\textwidth}{Miejsce na zrzut ekranu: strona główna po uruchomieniu}}
  \caption{Uruchomienie frontendu}
\end{figure}

\subsection{Uruchomienie kontenerowe}
\begin{verbatim}
docker compose up --build
\end{verbatim}
\begin{itemize}
  \item Usługa `wastefree-api` wystawia port 8080 (mapowanie 8080:8080).
  \item Aby zatrzymać: \texttt{docker compose down} (opcjonalnie z \texttt{-v} dla wolumenów).
\end{itemize}
\begin{figure}[H]
  \centering
  \fbox{\parbox{0.9\textwidth}{Miejsce na zrzut ekranu: logi kontenerów / dashboard Docker}}
  \caption{Uruchomienie w Docker Compose}
\end{figure}

\section{Konfiguracja środowisk (dev/test/prod)}
\subsection{Development}
\begin{itemize}
  \item Plik `appsettings.Development.json`; włączony detailed errors, CORS dla localhost.
  \item Frontend `environment.ts` wskazuje na lokalne API (np. \texttt{http://localhost:8080}).
\end{itemize}
\subsection{Test / staging}
\begin{itemize}
  \item Oddzielna baza danych; wyłączone logowanie szczegółowe.
  \item Sekrety dostarczane przez zmienne środowiskowe / KeyVault.
\end{itemize}
\subsection{Produkcja}
\begin{itemize}
  \item Reverse proxy (np. NGINX) + TLS.
  \item Monitorowanie i rotacja logów.
  \item Kopie zapasowe bazy; polityka aktualizacji migracji (okno serwisowe).
\end{itemize}

\section{Testy i weryfikacja}
\subsection{Backend}
\begin{verbatim}
cd API
dotnet test
\end{verbatim}
\subsection{Frontend}
\begin{verbatim}
cd UI
npm test
\end{verbatim}
\begin{figure}[H]
  \centering
  \fbox{\parbox{0.9\textwidth}{Miejsce na zrzut ekranu: raport z testów}}
  \caption{Wyniki testów}
\end{figure}
\subsection{Smoke / sanity}
\begin{itemize}
  \item Logowanie użytkownika.
  \item Utworzenie zamówienia na odbiór / dodanie zgłoszenia (kluczowa funkcja domenowa).
  \item Podgląd historii / powiadomień.
\end{itemize}

\section{Monitoring i logowanie}
\begin{itemize}
  \item Logi API: konsola (uruchomienie lokalne) lub stdout kontenera; rozważ przekierowanie do systemd journal / stack ELK.
  \item Poziomy logów konfigurowalne w `appsettings*.json` (sekcja `Logging`).
  \item Health-checki: skonfiguruj endpoint (np. `/health`) jeżeli dodany w API; uwzględnij w monitoringu.
\end{itemize}

\section{Aktualizacje i utrzymanie}
\begin{itemize}
  \item Aktualizacja zależności NuGet i npm; po zmianach uruchom testy i ewentualne migracje DB.
  \item Backup bazy danych przed wdrożeniem migracji produkcyjnych.
  \item Obrazy Docker: buduj z tagami wersji; czyść stare obrazy/wolumeny według polityki.
\end{itemize}

\section{Rozwiązywanie problemów}
\begin{itemize}
  \item \textbf{API nie startuje}: sprawdź connection string, zastosuj migracje, upewnij się że baza nasłuchuje.
  \item \textbf{UI nie łączy z API}: zweryfikuj adres w `environment.ts` oraz CORS.
  \item \textbf{Błędy przy \texttt{npm install}}: usuń \texttt{node\_modules}, \texttt{package-lock.json} i ponów instalację; upewnij się, że wersja Node jest zgodna (18/20).
  \item \textbf{Problemy w Docker}: sprawdź porty w `docker-compose.yml`, prawa do wolumenów, oraz zmienne środowiskowe przekazywane do kontenerów.
\end{itemize}
\begin{figure}[H]
  \centering
  \fbox{\parbox{0.9\textwidth}{Miejsce na zrzut ekranu: przykładowy log błędu i jego rozwiązanie}}
  \caption{Przykładowe logi diagnostyczne}
\end{figure}

\end{document}
