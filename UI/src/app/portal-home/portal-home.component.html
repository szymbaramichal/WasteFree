<div class="portal-home container-fluid py-3">
	<!-- Hero / Welcome -->
	<div class="row g-3 align-items-stretch mb-1">
		<div class="col-12">
			<div class="hero-card p-4 position-relative overflow-hidden rounded-4">
				<div class="d-flex flex-column flex-lg-row align-items-lg-center justify-content-between gap-3">
					<div>
						<h2 class="mb-2 fw-semibold">{{ 'portal.home.welcome' | translate }} <span *ngIf="currentUser() as u">{{ u.username }}</span> ðŸ‘‹</h2>
						<p class="lead mb-3 text-secondary">{{ 'portal.home.lead' | translate }}</p>
						<div class="d-flex flex-wrap gap-2">
											<a routerLink="/portal/wallet" class="btn btn-primary btn-sm d-inline-flex align-items-center gap-1 shadow-sm">
												<span>{{ 'portal.home.actions.wallet' | translate }}</span>
							</a>
											<a routerLink="/portal/inbox" class="btn btn-outline-secondary btn-sm d-inline-flex align-items-center gap-1">
												<span>{{ 'portal.home.actions.notifications' | translate }} <span *ngIf="inbox.counter()">({{ inbox.counter() }})</span></span>
							</a>
						</div>
					</div>
					<div class="text-end flex-grow-1 d-flex justify-content-end">
						<div class="circle-decoration">
							<div class="bubble one"></div>
							<div class="bubble two"></div>
							<div class="bubble three"></div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Stats -->
	<div class="row g-3 mb-2">
		<div class="col-6 col-md-3" *ngFor="let s of stats()">
			<div class="stat-card p-3 h-100 rounded-3">
				<div class="d-flex align-items-center justify-content-between mb-1">
					<div class="icon flex-shrink-0" [innerHTML]="iconPath(s.icon)"></div>
					<span class="badge bg-light text-dark fw-normal small">{{ s.unit || ' ' }}</span>
				</div>
				<div class="stat-value fw-bold">{{ s.value | number:'1.0-0' }}</div>
				<div class="stat-label small text-uppercase text-muted fw-semibold">{{ s.labelKey | translate }}</div>
			</div>
		</div>
	</div>

	<div class="row g-3">
		<!-- Recent Notifications -->
		<div class="col-12 col-lg-7">
			<div class="card shadow-sm h-100 rounded-4">
				<div class="card-body d-flex flex-column">
					<div class="d-flex align-items-center justify-content-between mb-2">
						<h5 class="m-0 d-flex align-items-center gap-2">
							<span class="notif-dot"></span>
											{{ 'portal.home.section.recentNotifications' | translate }}
						</h5>
										<a routerLink="/portal/inbox" class="small text-decoration-none">{{ 'portal.home.actions.notifications' | translate }} &rarr;</a>
					</div>
					<ul class="list-unstyled mb-0 flex-grow-1" *ngIf="recent().length; else noNotif">
						<li *ngFor="let n of recent(); trackBy: inboxTrack" class="d-flex align-items-start gap-3 py-2 notif-item" [class.unread]="!n.read">
							<div class="notif-icon rounded-circle text-white d-flex align-items-center justify-content-center" [ngClass]="'bg-' + notifTypeColor(n.type)">
								<svg *ngIf="n.type==='warning'" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 9v4"/><path d="M12 17h.01"/><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/></svg>
								<svg *ngIf="n.type==='success'" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6L9 17l-5-5"/></svg>
								<svg *ngIf="n.type==='info'" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12" y2="8"/></svg>
								<svg *ngIf="n.type!=='info' && n.type!=='warning' && n.type!=='success'" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/></svg>
							</div>
							<div class="flex-grow-1">
								<div class="d-flex justify-content-between align-items-start gap-2 mb-1 flex-wrap">
									<strong class="small">{{ n.title }}</strong>
									<span class="text-muted time small">{{ relativeDate(n.createdAt) }}</span>
								</div>
								<div class="small text-muted" [innerHTML]="formatMessage(n.message)"></div>
							</div>
						</li>
					</ul>
					<ng-template #noNotif>
									<div class="text-center text-muted small py-4">{{ 'portal.home.empty.notifications' | translate }}</div>
					</ng-template>
				</div>
			</div>
		</div>

		<!-- Quick Actions & Balance -->
		<div class="col-12 col-lg-5">
			<div class="card shadow-sm mb-3 rounded-4">
				<div class="card-body">
					  <h5 class="mb-3">{{ 'portal.home.section.quickActions' | translate }}</h5>
					<div class="d-flex flex-wrap gap-2">
									<a routerLink="/portal/wallet" class="btn btn-outline-primary btn-sm">{{ 'portal.home.quick.topup' | translate }}</a>
									<a routerLink="/portal/wallet" class="btn btn-outline-success btn-sm">{{ 'portal.home.quick.withdraw' | translate }}</a>
									<a routerLink="/portal/inbox" class="btn btn-outline-secondary btn-sm">{{ 'portal.home.quick.notifications' | translate }}</a>
					</div>
				</div>
			</div>
			<div class="card shadow-sm rounded-4">
				<div class="card-body d-flex flex-column gap-2">
								<h6 class="text-muted m-0">{{ 'portal.home.section.balance' | translate }}</h6>
					<div class="display-6 fw-semibold balance-value">{{ balance | number:'1.2-2' }} PLN</div>
					<div class="progress rounded-pill" style="height:6px;">
						<div class="progress-bar" role="progressbar" [style.width]="(balance/2000*100) + '%'" aria-valuemin="0" aria-valuemax="2000"></div>
					</div>
								<small class="text-muted">{{ 'portal.home.balance.goal' | translate }}: 2000 PLN</small>
				</div>
			</div>
		</div>
	</div>
</div>
