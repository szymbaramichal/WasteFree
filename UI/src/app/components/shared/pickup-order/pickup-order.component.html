
<div class="pickup-order container-fluid px-3">
	<div class="card pickup-card border-0 shadow-lg mx-auto">
		<div class="card-header gradient-groups text-white position-relative overflow-hidden">
			<div class="pickup-header d-flex align-items-center justify-content-between flex-wrap gap-3">
				<div class="pickup-header__title d-flex align-items-center gap-3">
					<div class="pickup-header__icon">
						<img src="/assets/images/pickup.svg" alt="" aria-hidden="true" />
					</div>
					<div class="pickup-header__text">
						<h5 class="mb-1 fw-bold">{{ 'pickupOrder.title' | translate }}</h5>
						<small>{{ currentStepConfig().headerLeadKey | translate }}</small>
					</div>
				</div>
			</div>
			<div class="header-accent"></div>
		</div>
		<div class="card-body p-0 pickup-card__body">
			<div class="pickup-stepper">
				<div class="step-indicator" role="list">
					<div
						*ngFor="let step of steps; index as i"
						class="step-indicator__item"
						[class.step-indicator__item--active]="i === currentStep()"
						[class.step-indicator__item--completed]="i < currentStep()"
						role="listitem"
						[attr.aria-current]="i === currentStep() ? 'step' : null"
					>
						<span class="step-indicator__number">{{ i + 1 }}</span>
						<span class="step-indicator__label">{{ step.labelKey | translate }}</span>
					</div>
				</div>
			</div>
			<div class="pickup-content">
				<form class="pickup-form" [formGroup]="form" novalidate>
					<div [ngSwitch]="currentStep()">
						<ng-container *ngSwitchCase="0">
							<fieldset class="option-grid"
								[attr.aria-describedby]="serviceTypeCtrl.invalid && (serviceTypeCtrl.dirty || serviceTypeCtrl.touched) ? 'orderTypeHint' : null"
							[attr.aria-label]="('pickupOrder.steps.orderType' | translate) || null">
								<legend class="visually-hidden">{{ 'pickupOrder.steps.orderType' | translate }}</legend>
								<label
									class="option-card"
									*ngFor="let option of serviceOptions; trackBy: trackOptionByValue"
									[class.option-card--active]="serviceTypeCtrl.value === option.value"
									[class.option-card--disabled]="option.disabled"
								>
									<div class="option-card__badge" *ngIf="option.disabled">
										{{ 'common.soon' | translate }}
									</div>
									<input
										type="radio"
										class="option-card__input"
										formControlName="serviceType"
										name="serviceType"
										[value]="option.value"
										[attr.disabled]="option.disabled ? '' : null"
									/>
									<div class="option-card__icon" aria-hidden="true">
										<img [src]="option.icon" alt="" class="option-card__image" />
									</div>
									<div class="option-card__content">
										<div class="option-card__title">{{ option.titleKey | translate }}</div>
										<p class="option-card__description text-muted mb-0">{{ option.descriptionKey | translate }}</p>
									</div>
								</label>
							</fieldset>
							<div id="orderTypeHint" class="form-text text-danger mt-2" *ngIf="serviceTypeCtrl.invalid && (serviceTypeCtrl.dirty || serviceTypeCtrl.touched)">
								{{ 'pickupOrder.validation.serviceType' | translate }}
							</div>
						</ng-container>

						<ng-container *ngSwitchCase="1">
							<div class="participants-section">
								<div class="participants-column">
									<div class="participants-column__header">
										<h6 class="mb-1">{{ 'pickupOrder.step.participants.groupsTitle' | translate }}</h6>
										<p class="text-muted mb-0">{{ 'pickupOrder.step.participants.groupsLead' | translate }}</p>
									</div>
									<div
										class="participants-groups"
										role="radiogroup"
										[attr.aria-busy]="loadingGroups()"
									>
										<div class="participants-state" *ngIf="loadingGroups()">
											<div class="spinner-border spinner-border-sm text-success" role="status" aria-hidden="true"></div>
											<span>{{ 'pickupOrder.step.participants.loading' | translate }}</span>
										</div>
										<ng-container *ngIf="!loadingGroups()">
											<div class="participants-groups__section" *ngIf="individualGroup() as privateGroup">
												<span class="participants-groups__label">{{ 'pickupOrder.step.participants.section.individual' | translate }}</span>
												<button
													type="button"
													class="participants-group-card participants-group-card--private"
													[class.participants-group-card--active]="privateGroup.id === selectedGroupId()"
													(click)="onSelectGroup(privateGroup.id)"
												>
													<span class="participants-group-card__name">{{ 'pickupOrder.step.participants.privateGroup' | translate }}</span>
													<span class="participants-group-card__meta">
														{{ privateGroup.users.length }}
														{{ 'pickupOrder.step.participants.membersSuffix' | translate }}
													</span>
												</button>
											</div>
											<div class="participants-groups__section" *ngIf="groups().length">
												<span class="participants-groups__label">{{ 'pickupOrder.step.participants.section.groups' | translate }}</span>
												<button
													type="button"
													class="participants-group-card"
													*ngFor="let groupVm of groups(); trackBy: trackGroupById"
													[class.participants-group-card--active]="groupVm.id === selectedGroupId()"
													(click)="onSelectGroup(groupVm.id)"
												>
													<span class="participants-group-card__name">
														{{ groupVm.name || ('pickupOrder.step.participants.unnamedGroup' | translate) }}
													</span>
													<span class="participants-group-card__meta">
														{{ groupVm.users.length }}
														{{ 'pickupOrder.step.participants.membersSuffix' | translate }}
													</span>
												</button>
											</div>
											<div class="participants-state participants-state--empty" *ngIf="!individualGroup() && !groups().length">
												<span>{{ 'pickupOrder.step.participants.empty' | translate }}</span>
											</div>
										</ng-container>
									</div>
									<div class="form-text text-danger mt-2" *ngIf="groupIdCtrl.invalid && (groupIdCtrl.dirty || groupIdCtrl.touched)">
										{{ 'pickupOrder.validation.group' | translate }}
									</div>
								</div>

								<div class="participants-column">
									<div class="participants-column__header">
										<h6 class="mb-1">{{ 'pickupOrder.step.participants.usersTitle' | translate }}</h6>
										<p class="text-muted mb-0">{{ 'pickupOrder.step.participants.usersLead' | translate }}</p>
									</div>
									<div class="participants-users" [attr.aria-live]="selectedGroupId() ? 'polite' : 'off'">
										<div class="participants-state participants-state--hint" *ngIf="!selectedGroupId() && groups().length">
											<span>{{ 'pickupOrder.step.participants.noGroupSelected' | translate }}</span>
										</div>
										<div class="participants-state participants-state--empty" *ngIf="selectedGroupId() && !selectedGroupUsers().length">
											<span>{{ 'pickupOrder.step.participants.noUsers' | translate }}</span>
										</div>
										<ul class="participants-users__list" *ngIf="selectedGroupId() && selectedGroupUsers().length">
											<li
												class="participants-users__item"
												*ngFor="let user of selectedGroupUsers(); trackBy: trackUserById"
											>
												<label class="participants-users__label" [class.participants-users__label--disabled]="user.disabled">
													<input
														type="checkbox"
														class="form-check-input"
														[disabled]="user.disabled"
														[checked]="participantIdsCtrl.value?.includes(user.id)"
														(change)="onToggleParticipant(user.id, $any($event.target).checked)"
													/>
													<div class="participants-users__details">
														<span class="participants-users__name">{{ user.username }}</span>
														<small class="text-muted">{{ groupRoleKey(user.role) | translate }}</small>
													</div>
													<span class="participants-users__badge" *ngIf="user.disabled">{{ 'pickupOrder.step.participants.pending' | translate }}</span>
												</label>
											</li>
										</ul>
										<div class="participants-state participants-state--hint" *ngIf="selectedGroupId() && selectedGroupUsers().length && !hasSelectableParticipants()">
											<span>{{ 'pickupOrder.step.participants.allPending' | translate }}</span>
										</div>
									</div>
									<div class="form-text text-danger mt-2" *ngIf="participantIdsCtrl.invalid && (participantIdsCtrl.dirty || participantIdsCtrl.touched)">
										{{ 'pickupOrder.validation.participants' | translate }}
									</div>
								</div>
							</div>
						</ng-container>

						<ng-container *ngSwitchCase="summaryStepIndex">
							<div class="summary-step">
								<div class="summary-step__intro">
									<h6 class="mb-1">{{ 'pickupOrder.step.summary.title' | translate }}</h6>
									<p class="text-muted mb-0">{{ 'pickupOrder.step.summary.lead' | translate }}</p>
								</div>
								<ng-container *ngIf="summaryRequest() as summary; else summaryMissing">
									<div class="summary-grid">
										<div class="summary-card">
											<span class="summary-card__label">{{ 'pickupOrder.summary.group' | translate }}</span>
											<div class="summary-card__value">
												<ng-container *ngIf="selectedGroup() as group; else summaryNoGroup">
													<span class="d-block fw-semibold">
														{{ group.isPrivate ? ('pickupOrder.step.participants.privateGroup' | translate) : (group.name || ('pickupOrder.step.participants.unnamedGroup' | translate)) }}
													</span>
													<small class="text-muted d-block" *ngIf="group.address">
														{{ group.address.street }}
														<br />
														{{ group.address.postalCode }} {{ group.address.city | localizedCity }}
													</small>
												</ng-container>
											</div>
											<ng-template #summaryNoGroup>
												<span class="text-muted">{{ 'pickupOrder.summary.noGroup' | translate }}</span>
											</ng-template>
										</div>
										<div class="summary-card">
											<span class="summary-card__label">{{ 'pickupOrder.summary.pickupDetails' | translate }}</span>
											<ul class="summary-list">
												<li class="summary-list__item">
													<span>{{ 'pickupOrder.summary.pickupType' | translate }}</span>
													<span class="fw-semibold">{{ (selectedOption()?.titleKey ?? '') | translate }}</span>
												</li>
												<li class="summary-list__item" *ngIf="selectedOption()?.value === pickupOptionEnum.Container">
													<span>{{ 'pickupOrder.summary.containerSize' | translate }}</span>
													<span class="fw-semibold">{{ (selectedContainerSizeOption()?.labelKey ?? '') | translate }}</span>
												</li>
												<li class="summary-list__item">
													<span>{{ 'pickupOrder.summary.priority' | translate }}</span>
													<span class="badge summary-chip" [class.summary-chip--yes]="summary.isHighPriority">
														{{ (summary.isHighPriority ? 'common.yes' : 'common.no') | translate }}
													</span>
												</li>
												<li class="summary-list__item">
													<span>{{ 'pickupOrder.summary.collectingService' | translate }}</span>
													<span class="badge summary-chip" [class.summary-chip--yes]="summary.collectingService">
														{{ (summary.collectingService ? 'common.yes' : 'common.no') | translate }}
													</span>
												</li>
											</ul>
										</div>
										<div class="summary-card">
											<span class="summary-card__label">{{ 'pickupOrder.summary.schedule' | translate }}</span>
											<div class="summary-card__value">
												<ng-container *ngIf="selectedOption()?.value === pickupOptionEnum.Container; else singleSchedule">
													<ng-container *ngIf="summaryDropOffDate() || summaryPickupDate(); else summaryNoSchedule">
														<div class="summary-schedule">
															<div class="summary-schedule__row" *ngIf="summaryDropOffDate() as dropOff">
																<span class="summary-schedule__label">{{ 'pickupOrder.summary.dropOff' | translate }}</span>
																<div class="summary-schedule__value">
																	<span class="d-block fw-semibold">{{ dropOff | date:'dd.MM.yyyy' }}</span>
																	<small class="text-muted d-block">{{ dropOff | date:'HH:mm' }}</small>
																</div>
															</div>
															<div class="summary-schedule__row" *ngIf="summaryPickupDate() as pickup">
																<span class="summary-schedule__label">{{ 'pickupOrder.summary.pickup' | translate }}</span>
																<div class="summary-schedule__value">
																	<span class="d-block fw-semibold">{{ pickup | date:'dd.MM.yyyy' }}</span>
																	<small class="text-muted d-block">{{ pickup | date:'HH:mm' }}</small>
																</div>
															</div>
														</div>
													</ng-container>
												</ng-container>
												<ng-template #singleSchedule>
													<ng-container *ngIf="summaryPickupDate() as scheduled; else summaryNoSchedule">
														<span class="d-block fw-semibold">{{ scheduled | date:'dd.MM.yyyy' }}</span>
														<small class="text-muted d-block">{{ scheduled | date:'HH:mm' }}</small>
													</ng-container>
												</ng-template>
											</div>
											<ng-template #summaryNoSchedule>
												<div class="summary-card__value text-muted">{{ 'pickupOrder.summary.noSchedule' | translate }}</div>
											</ng-template>
										</div>
									</div>
									<div class="summary-lower">
										<div class="summary-section summary-lower__participants">
										<div class="summary-section__header">
											<h6 class="mb-0">{{ 'pickupOrder.summary.participants' | translate }}</h6>
											<span class="badge bg-light text-dark">{{ selectedParticipants().length }}</span>
										</div>
										<ul class="summary-participants__list" *ngIf="selectedParticipants().length; else summaryNoParticipants">
											<li class="summary-participants__item" *ngFor="let user of selectedParticipants(); trackBy: trackUserById">
												<span class="summary-participants__name">{{ user.username }}</span>
												<small class="text-muted">{{ groupRoleKey(user.role) | translate }}</small>
											</li>
										</ul>
										<ng-template #summaryNoParticipants>
											<p class="text-muted mb-0">{{ 'pickupOrder.summary.noParticipants' | translate }}</p>
										</ng-template>
									</div>
										<div class="summary-cost summary-lower__cost" [attr.aria-live]="currentStep() === summaryStepIndex ? 'polite' : 'off'">
											<div class="summary-cost__header">
												<div class="summary-cost__title">
													<span class="summary-cost__icon" aria-hidden="true"></span>
													<h6 class="summary-cost__heading mb-0">{{ 'pickupOrder.summary.cost.title' | translate }}</h6>
												</div>
											</div>
											<div class="summary-cost__body">
												<div class="summary-cost__loading" *ngIf="costLoading(); else costContent">
													<div class="spinner-border spinner-border-sm text-success" role="status" aria-hidden="true"></div>
													<span>{{ 'pickupOrder.summary.cost.loading' | translate }}</span>
												</div>
											</div>
											<ng-container *ngIf="estimatedCost() !== null && prepaidUtilizationFee() !== null; else summaryCostDefaultNote">
												<small class="summary-cost__note">
													{{
														'pickupOrder.summary.cost.prepaidCopy'
														| translate:{
															estimatedCost: (estimatedCost() | currency:'PLN':'symbol':'1.2-2'),
															prepaidUtilizationFee: (prepaidUtilizationFee() | currency:'PLN':'symbol':'1.2-2')
														}
													}}
												</small>
											</ng-container>
											<ng-template #summaryCostDefaultNote>
												<small class="summary-cost__note">{{ 'pickupOrder.summary.cost.note' | translate }}</small>
											</ng-template>
											<ng-template #costContent>
												<ng-container *ngIf="estimatedCost() !== null; else costMessages">
													<span class="summary-cost__amount">{{ estimatedCost() | currency:'PLN':'symbol':'1.2-2' }}</span>
													<div class="summary-cost__breakdown" *ngIf="prepaidUtilizationFee() !== null">
														<span class="summary-cost__breakdown-label">{{ 'pickupOrder.summary.cost.prepaidLabel' | translate }}</span>
														<span class="summary-cost__breakdown-value">{{ prepaidUtilizationFee() | currency:'PLN':'symbol':'1.2-2' }}</span>
													</div>
												</ng-container>
											</ng-template>
											<ng-template #costMessages>
												<ng-container *ngIf="costMessage() as messageKey; else costUnavailable">
													<div class="summary-cost__alert" [ngClass]="costMessageType() === 'error' ? 'summary-cost__alert--error' : 'summary-cost__alert--info'" role="status">
														{{ messageKey | translate }}
													</div>
												</ng-container>
											</ng-template>
											<ng-template #costUnavailable>
												<div class="summary-cost__alert summary-cost__alert--info" role="status">
													{{ 'pickupOrder.summary.cost.unavailable' | translate }}
												</div>
											</ng-template>
										</div>
									</div>
									<div class="summary-messages">
										<div class="alert alert-success" *ngIf="submittedOrder()">
											{{ 'pickupOrder.summary.success' | translate }}
										</div>
										<div class="alert alert-danger" *ngIf="submitError() as errorKey">
											{{ errorKey | translate }}
										</div>
									</div>
								</ng-container>
								<ng-template #summaryMissing>
									<div class="summary-empty text-center text-muted">
										<p class="mb-0">{{ 'pickupOrder.summary.incompleteHint' | translate }}</p>
									</div>
								</ng-template>
							</div>
						</ng-container>

						<ng-container *ngSwitchCase="2">
							<div class="row g-4 address-step">
								<div class="col-lg-5">
									<div class="address-card h-100">
										<h6 class="mb-1">{{ 'pickupOrder.step.address.selectedGroupTitle' | translate }}</h6>
										<p class="text-muted mb-2">{{ 'pickupOrder.step.address.selectedGroupLead' | translate }}</p>
										<ng-container *ngIf="selectedGroup() as group; else noGroupAddress">
											<div class="address-card__group-name">
												{{ group.isPrivate ? ('pickupOrder.step.participants.privateGroup' | translate) : (group.name || ('pickupOrder.step.participants.unnamedGroup' | translate)) }}
											</div>
											<div class="address-card__address">
												<span>{{ group.address.street }}</span>
												<span>{{ group.address.postalCode }} {{ group.address.city | localizedCity }}</span>
											</div>
										</ng-container>
										<ng-template #noGroupAddress>
											<div class="address-card__empty">
												{{ 'pickupOrder.step.address.noGroup' | translate }}
											</div>
										</ng-template>
									</div>
								</div>
								<div class="col-lg-7">
									<div class="address-card h-100">
										<h6 class="mb-1">{{ 'pickupOrder.step.address.scheduleTitle' | translate }}</h6>
										<div class="row g-3">
											<ng-container *ngIf="serviceTypeCtrl.value === pickupOptionEnum.Container">
												<div class="col-12">
													<span class="schedule-section__label">{{ 'pickupOrder.step.address.dropOffSection' | translate }}</span>
												</div>
												<div class="col-md-6">
													<mat-form-field appearance="outline" class="w-100">
														<mat-label>{{ 'pickupOrder.step.address.dropOffDateLabel' | translate }}</mat-label>
														<input
															matInput
															[matDatepicker]="dropOffPicker"
															[min]="minPickupDate"
															id="dropOffDate"
															formControlName="dropOffDate"
														/>
														<mat-hint>{{ 'pickupOrder.step.address.dropOffDateHint' | translate }}</mat-hint>
														<mat-datepicker-toggle matIconSuffix [for]="dropOffPicker"></mat-datepicker-toggle>
														<mat-datepicker #dropOffPicker></mat-datepicker>
														<mat-error *ngIf="dropOffDateCtrl.invalid && (dropOffDateCtrl.dirty || dropOffDateCtrl.touched)">
															{{ 'pickupOrder.validation.dropOffDate' | translate }}
													</mat-error>
												</mat-form-field>
											</div>
											<div class="col-md-6">
												<mat-form-field appearance="outline" class="w-100">
													<mat-label>{{ 'pickupOrder.step.address.dropOffTimeLabel' | translate }}</mat-label>
													<mat-select
														id="dropOffTime"
														formControlName="dropOffTime"
													>
														<mat-option *ngFor="let option of timeOptions" [value]="option.value">
															{{ option.label }}
														</mat-option>
													</mat-select>
													<mat-hint>{{ 'pickupOrder.step.address.dropOffTimeHint' | translate }}</mat-hint>
													<mat-error *ngIf="dropOffTimeCtrl.invalid && (dropOffTimeCtrl.dirty || dropOffTimeCtrl.touched)">
														{{ 'pickupOrder.validation.dropOffTime' | translate }}
													</mat-error>
												</mat-form-field>
											</div>
												<div class="col-12">
													<span class="schedule-section__label">{{ 'pickupOrder.step.address.pickupSection' | translate }}</span>
												</div>
											</ng-container>
											<div class="col-md-6">
												<mat-form-field appearance="outline" class="w-100">
													<mat-label>{{ 'pickupOrder.step.address.dateLabel' | translate }}</mat-label>
													<input
														matInput
														[matDatepicker]="pickupPicker"
														[min]="pickupDateMin()"
														id="pickupDate"
														formControlName="pickupDate"
													/>
													<mat-hint>{{ 'pickupOrder.step.address.dateHint' | translate }}</mat-hint>
													<mat-datepicker-toggle matIconSuffix [for]="pickupPicker"></mat-datepicker-toggle>
													<mat-datepicker #pickupPicker></mat-datepicker>
													<mat-error *ngIf="pickupDateCtrl.hasError('required') && (pickupDateCtrl.dirty || pickupDateCtrl.touched)">
														{{ 'pickupOrder.validation.date' | translate }}
													</mat-error>
													<mat-error *ngIf="form.hasError('pickupBeforeDropOff') && (pickupDateCtrl.dirty || pickupDateCtrl.touched)">
														{{ 'pickupOrder.validation.scheduleSequence' | translate }}
													</mat-error>
												</mat-form-field>
											</div>
											<div class="col-md-6">
												<mat-form-field appearance="outline" class="w-100">
													<mat-label>{{ 'pickupOrder.step.address.timeLabel' | translate }}</mat-label>
													<mat-select
														id="pickupTime"
														formControlName="pickupTime"
													>
														<mat-option *ngFor="let option of timeOptions" [value]="option.value">
															{{ option.label }}
														</mat-option>
													</mat-select>
													<mat-hint>{{ 'pickupOrder.step.address.timeHint' | translate }}</mat-hint>
													<mat-error *ngIf="pickupTimeCtrl.hasError('required') && (pickupTimeCtrl.dirty || pickupTimeCtrl.touched)">
														{{ 'pickupOrder.validation.time' | translate }}
													</mat-error>
													<mat-error *ngIf="form.hasError('pickupBeforeDropOff') && (pickupTimeCtrl.dirty || pickupTimeCtrl.touched)">
														{{ 'pickupOrder.validation.scheduleSequence' | translate }}
													</mat-error>
												</mat-form-field>
											</div>
										<div class="col-12 text-center text-muted small mt-4">
											{{ 'pickupOrder.step.address.timeDisclaimer' | translate }}
										</div>
										</div>
									</div>
								</div>
							</div>
						</ng-container>

						<ng-container *ngSwitchCase="3">
							<div class="details-step">
								<div class="details-step__intro">
									<h6 class="mb-1">{{ 'pickupOrder.step.details.title' | translate }}</h6>
									<p class="text-muted mb-0">{{ 'pickupOrder.step.details.lead' | translate }}</p>
								</div>
								<div class="details-step__options">
									<div class="details-option details-option--container" *ngIf="serviceTypeCtrl.value === pickupOptionEnum.Container">
										<div class="details-option__header">
											<label class="form-label fw-semibold mb-0" for="containerSize">
												{{ 'pickupOrder.step.details.container.label' | translate }}
											</label>
											<span class="details-option__badge details-option__badge--required">
												{{ 'pickupOrder.step.details.requiredBadge' | translate }}
											</span>
										</div>
										<p class="details-option__description text-muted mb-0">
											{{ 'pickupOrder.step.details.container.description' | translate }}
										</p>
										<select
											id="containerSize"
											class="form-select"
											formControlName="containerSize"
											[attr.aria-describedby]="containerSizeCtrl.invalid && (containerSizeCtrl.dirty || containerSizeCtrl.touched) ? 'containerSizeHint' : null"
										>
											<option *ngFor="let option of containerSizeOptions" [ngValue]="option.value">
												{{ option.labelKey | translate }}
											</option>
										</select>
										<div
											id="containerSizeHint"
											class="form-text text-danger"
											*ngIf="containerSizeCtrl.invalid && (containerSizeCtrl.dirty || containerSizeCtrl.touched)"
										>
											{{ 'pickupOrder.validation.containerSize' | translate }}
										</div>
										<div class="container-size-info mt-3" role="list">
											<div class="container-size-info__item mb-2" role="listitem" *ngFor="let option of containerSizeOptions">
												<strong class="d-block">{{ option.labelKey | translate }}</strong>
												<small class="text-muted">{{ option.descriptionKey | translate }}</small>
											</div>
										</div>
									</div>
									<div class="details-option">
										<div class="details-option__header">
											<div class="form-check form-switch">
												<input
													type="checkbox"
													id="pickupPriority"
													class="form-check-input"
													formControlName="isHighPriority"
												/>
												<label class="form-check-label fw-semibold" for="pickupPriority">
													{{ 'pickupOrder.step.details.priority.label' | translate }}
												</label>
											</div>
											<span class="details-option__badge">{{ 'pickupOrder.step.details.optionalBadge' | translate }}</span>
										</div>
										<p class="details-option__description text-muted mb-0">
											{{ 'pickupOrder.step.details.priority.description' | translate }}
										</p>
									</div>
									<div class="details-option">
										<div class="details-option__header">
											<div class="form-check form-switch">
												<input
													type="checkbox"
													id="pickupCollecting"
													class="form-check-input"
													formControlName="collectingService"
												/>
												<label class="form-check-label fw-semibold" for="pickupCollecting">
													{{ 'pickupOrder.step.details.collecting.label' | translate }}
												</label>
											</div>
											<span class="details-option__badge">{{ 'pickupOrder.step.details.optionalBadge' | translate }}</span>
										</div>
										<p class="details-option__description text-muted mb-0">
											{{ 'pickupOrder.step.details.collecting.description' | translate }}
										</p>
									</div>
								</div>
							</div>
						</ng-container>

						<ng-container *ngSwitchDefault>
							<div class="placeholder-step text-center py-5">
								<h3 class="h5 mb-2" *ngIf="currentStepConfig().placeholderTitleKey as titleKey">{{ titleKey | translate }}</h3>
								<p class="text-muted mb-3" *ngIf="currentStepConfig().placeholderLeadKey as leadKey">{{ leadKey | translate }}</p>
								<div class="selected-option" *ngIf="selectedOption() as selected">
									<span class="badge bg-light text-dark">{{ selected.titleKey | translate }}</span>
								</div>
								<p class="text-muted mt-3 mb-0" *ngIf="currentStepConfig().placeholderBodyKey as bodyKey">{{ bodyKey | translate }}</p>
							</div>
						</ng-container>
					</div>

					<div class="pickup-form__actions">
						<button
							type="button"
							class="btn btn-outline-secondary"
							(click)="onBack()"
							[disabled]="submitting()"
							*ngIf="currentStep() > 0"
						>
							{{ 'pickupOrder.actions.back' | translate }}
						</button>
						<button type="button" class="btn btn-primary btn-elevated" (click)="onNext()" [disabled]="primaryActionDisabled()">
							<span
								class="spinner-border spinner-border-sm me-2"
								role="status"
								aria-hidden="true"
								*ngIf="currentStep() === summaryStepIndex && submitting()"
							></span>
							<span>
								{{ currentStep() === summaryStepIndex
									? ('pickupOrder.actions.submit' | translate)
									: ('pickupOrder.actions.next' | translate) }}
							</span>
						</button>
					</div>
				</form>
			</div>
		</div>
	</div>
</div>
