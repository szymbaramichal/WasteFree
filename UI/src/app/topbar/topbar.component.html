<nav *ngIf="visible" class="topbar navbar navbar-expand-lg" [ngClass]="currentUser.user()?.role == userRole.GarbageAdmin ? 'role-garbadmin' : 'role-user'">
  <div class="container-fluid topbar-inner">
    <a class="navbar-brand brand text-white" routerLink="/portal">{{ 'topbar.portalTitle' | translate }}</a>
    <button class="navbar-toggler" type="button" (click)="navOpen = !navOpen" [attr.aria-expanded]="navOpen" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" [class.show]="navOpen">
      <div class="d-flex align-items-center gap-2 ms-auto flex-wrap">
        <div class="inbox-slot order-lg-2" *ngIf="currentUser.user()">
          <button class="inbox-pill link" (click)="openInbox()" [title]="('topbar.openInbox' | translate)" [ngClass]="{'jiggle': animateInbox}">
            <img src="/assets/images/bell.svg" alt="inbox" width="18" height="18" class="inbox-icon" aria-hidden="true" />
            <span class="inbox-count" *ngIf="inboxCount">{{ inboxCount }}</span>
          </button>
        </div>
        <div class="wallet-slot order-lg-2" *ngIf="(walletBalance$ | async) !== null">
          <a class="wallet-pill link" routerLink="/portal/wallet" [title]="('topbar.openWallet' | translate)">
            <img src="/assets/images/wallet.svg" alt="wallet" width="18" height="18" class="wallet-icon" aria-hidden="true" />
            <div class="wallet-value ms-2">
              <div class="amount">{{ (walletBalance$ | async) | number:'1.2-2' }}</div>
              <div class="currency">PLN</div>
            </div>
          </a>
        </div>
        <div class="lang-slot order-lg-1">
          <app-language-switcher></app-language-switcher>
        </div>
        <div class="user-info order-lg-3" *ngIf="currentUser.user() as u">
          <span class="logged d-none d-lg-inline">{{ 'topbar.hey' | translate }} <strong>{{ u.username }}</strong>! ({{ roleKeyMap[u.role] | translate }})</span>
          <button class="btn btn-outline-light btn-sm" (click)="logout()">{{ 'topbar.logout' | translate }}</button>
        </div>
        <div class="user-info order-lg-3" *ngIf="!currentUser.user()">
          <a class="link" routerLink="/portal">{{ 'topbar.goPortal' | translate }}</a>
        </div>
      </div>
    </div>
  </div>
</nav>